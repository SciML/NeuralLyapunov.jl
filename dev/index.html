<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · NeuralLyapunov.jl</title><meta name="title" content="Home · NeuralLyapunov.jl"/><meta property="og:title" content="Home · NeuralLyapunov.jl"/><meta property="twitter:title" content="Home · NeuralLyapunov.jl"/><meta name="description" content="Documentation for NeuralLyapunov.jl."/><meta property="og:description" content="Documentation for NeuralLyapunov.jl."/><meta property="twitter:description" content="Documentation for NeuralLyapunov.jl."/><meta property="og:url" content="https://SciML.github.io/NeuralLyapunov.jl/"/><meta property="twitter:url" content="https://SciML.github.io/NeuralLyapunov.jl/"/><link rel="canonical" href="https://SciML.github.io/NeuralLyapunov.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>NeuralLyapunov.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralLyapunov.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralLyapunov.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="NeuralLyapunov"><a class="docs-heading-anchor" href="#NeuralLyapunov">NeuralLyapunov</a><a id="NeuralLyapunov-1"></a><a class="docs-heading-anchor-permalink" href="#NeuralLyapunov" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/SciML/NeuralLyapunov.jl">NeuralLyapunov</a>.</p><ul><li><a href="#NeuralLyapunov.LyapunovDecreaseCondition"><code>NeuralLyapunov.LyapunovDecreaseCondition</code></a></li><li><a href="#NeuralLyapunov.LyapunovMinimizationCondition"><code>NeuralLyapunov.LyapunovMinimizationCondition</code></a></li><li><a href="#NeuralLyapunov.NeuralLyapunovStructure"><code>NeuralLyapunov.NeuralLyapunovStructure</code></a></li><li><a href="#NeuralLyapunov.AsymptoticDecrease-Tuple{}"><code>NeuralLyapunov.AsymptoticDecrease</code></a></li><li><a href="#NeuralLyapunov.DontCheckDecrease"><code>NeuralLyapunov.DontCheckDecrease</code></a></li><li><a href="#NeuralLyapunov.DontCheckNonnegativity-Tuple{}"><code>NeuralLyapunov.DontCheckNonnegativity</code></a></li><li><a href="#NeuralLyapunov.ExponentialDecrease-Tuple{Real}"><code>NeuralLyapunov.ExponentialDecrease</code></a></li><li><a href="#NeuralLyapunov.NeuralLyapunovPDESystem-Tuple{SciMLBase.ODEFunction, Any, Any, NeuralLyapunovSpecification}"><code>NeuralLyapunov.NeuralLyapunovPDESystem</code></a></li><li><a href="#NeuralLyapunov.NonnegativeNeuralLyapunov-Tuple{Integer}"><code>NeuralLyapunov.NonnegativeNeuralLyapunov</code></a></li><li><a href="#NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, Function, Function, Any}"><code>NeuralLyapunov.NumericalNeuralLyapunovFunctions</code></a></li><li><a href="#NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, NeuralLyapunovStructure, Function, Any}"><code>NeuralLyapunov.NumericalNeuralLyapunovFunctions</code></a></li><li><a href="#NeuralLyapunov.PositiveSemiDefinite-Tuple{}"><code>NeuralLyapunov.PositiveSemiDefinite</code></a></li><li><a href="#NeuralLyapunov.PositiveSemiDefiniteStructure-Tuple{Integer}"><code>NeuralLyapunov.PositiveSemiDefiniteStructure</code></a></li><li><a href="#NeuralLyapunov.StrictlyPositiveDefinite-Tuple{}"><code>NeuralLyapunov.StrictlyPositiveDefinite</code></a></li><li><a href="#NeuralLyapunov.UnstructuredNeuralLyapunov-Tuple{}"><code>NeuralLyapunov.UnstructuredNeuralLyapunov</code></a></li><li><a href="#NeuralLyapunov.check_decrease-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.check_decrease</code></a></li><li><a href="#NeuralLyapunov.check_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.check_fixed_point</code></a></li><li><a href="#NeuralLyapunov.check_nonnegativity-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.check_nonnegativity</code></a></li><li><a href="#NeuralLyapunov.check_stationary_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.check_stationary_fixed_point</code></a></li><li><a href="#NeuralLyapunov.get_decrease_condition-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.get_decrease_condition</code></a></li><li><a href="#NeuralLyapunov.get_minimization_condition-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.get_minimization_condition</code></a></li><li><a href="#NeuralLyapunov.local_Lyapunov-Tuple{Function, Any, Any}"><code>NeuralLyapunov.local_Lyapunov</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.LyapunovDecreaseCondition" href="#NeuralLyapunov.LyapunovDecreaseCondition"><code>NeuralLyapunov.LyapunovDecreaseCondition</code></a> — <span class="docstring-category">Type</span></header><section><div><p>LyapunovDecreaseCondition(decrease, strength, check<em>fixed</em>point)</p><p>Specifies the form of the Lyapunov conditions to be used; training will enforce     decrease(V, dVdt) ≤ strength(state, fixed<em>point) The inequality will be approximated by the equation     relu(decrease(V, dVdt) - strength(state, fixed</em>point)) = 0.0 If check<em>fixed</em>point is false, then training assumes dVdt(fixed<em>point) = 0, but if check</em>fixed<em>point is true, then training will enforce dVdt(fixed</em>point) = 0.</p><p>If the dynamics truly have a fixed point at fixed<em>point and dVdt has been  defined properly in terms of the dynamics, then dVdt(fixed</em>point) will be 0 and there is no need to enforce dVdt(fixed<em>point) = 0, so check</em>fixed_point defaults to false.</p><p><strong>Examples:</strong></p><p>Asymptotic decrease can be enforced by requiring     dVdt ≤ -C |state - fixed_point|^2, which corresponds to     decrease = (V, dVdt) -&gt; dVdt     strength = (x, x0) -&gt; -C * (x - x0) ⋅ (x - x0)</p><p>Exponential decrease of rate k is proven by dVdt ≤ - k * V, so corresponds to     decrease = (V, dVdt) -&gt; dVdt + k * V     strength = (x, x0) -&gt; 0.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L343-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.LyapunovMinimizationCondition" href="#NeuralLyapunov.LyapunovMinimizationCondition"><code>NeuralLyapunov.LyapunovMinimizationCondition</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LyapunovMinimizationCondition</code></pre><p>Specifies the form of the Lyapunov conditions to be used.</p><p>If check<em>nonnegativity is true, training will attempt to enforce     V(state) ≥ strength(state, fixed</em>point) The inequality will be approximated by the equation     relu(strength(state, fixed<em>point) - V(state)) = 0.0 If check</em>fixed<em>point is true, then training will attempt to enforce      V(fixed</em>point) = 0</p><p><strong>Examples</strong></p><p>The condition that the Lyapunov function must be minimized uniquely at the fixed point can be represented as V(fixed<em>point) = 0, V(state) &gt; 0 when  state != fixed</em>point. This could be enfored by V ≥ ||state - fixed<em>point||^2, which would be represented, with check</em>nonnegativity = true, by     strength(state, fixed<em>point) = ||state - fixed</em>point||^2, paired with V(fixed<em>point) = 0, which can be enforced with      check</em>fixed_point = true</p><p>If V were structured such that it is always nonnegative, then V(fixed<em>point) = 0 is all that must be enforced in training for the Lyapunov function to be  uniquely minimized at fixed</em>point. So, in that case, we would use      check<em>nonnegativity = false;  check</em>fixed_point = true</p><p>In either case, relu = (t) -&gt; max(0.0, t) exactly represents the inequality,  but approximations of this function are allowed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L192-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.NeuralLyapunovStructure" href="#NeuralLyapunov.NeuralLyapunovStructure"><code>NeuralLyapunov.NeuralLyapunovStructure</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NeuralLyapunovStructure</code></pre><p>Specifies the structure of the neural Lyapunov function and its derivative.</p><p>Allows the user to define the Lyapunov in terms of the neural network to  structurally enforce Lyapunov conditions.  network<em>dim is the dimension of the output of the neural network. V(phi::Function, state, fixed</em>point) takes in the neural network, the state, and the fixed<em>point, and outputs the value of the Lyapunov function at state V̇(phi::Function, J</em>phi::Function, f::Function, state, fixed<em>point) takes in the neural network, the jacobian of the neural network, the dynamics (as a function of the state alone), the state, and the fixed</em>point, and outputs the time  derivative of the Lyapunov function at state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.AsymptoticDecrease-Tuple{}" href="#NeuralLyapunov.AsymptoticDecrease-Tuple{}"><code>NeuralLyapunov.AsymptoticDecrease</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">AsymptoticDecrease(strict; check_fixed_point, C)</code></pre><p>Constructs a LyapunovDecreaseCondition corresponding to asymptotic decrease.</p><p>If strict is false, the condition is dV/dt ≤ 0, and if strict is true, the  condition is dV/dt ≤ - C | state - fixed_point |^2</p><p>The inequality is represented by a ≥ b &lt;==&gt; relu(b-a) = 0.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L396-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.DontCheckDecrease" href="#NeuralLyapunov.DontCheckDecrease"><code>NeuralLyapunov.DontCheckDecrease</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">DontCheckDecrease(check_fixed_point = false)</code></pre><p>Constructs a LyapunovDecreaseCondition which represents not checking for  decrease of the Lyapunov function along system trajectories. This is appropriate in cases when the Lyapunov decrease condition has been structurally enforced.</p><p>It is still possible to check for dV/dt = 0 at fixed_point, even in this case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L467-L475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.DontCheckNonnegativity-Tuple{}" href="#NeuralLyapunov.DontCheckNonnegativity-Tuple{}"><code>NeuralLyapunov.DontCheckNonnegativity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DontCheckNonnegativity(check_fixed_point)</code></pre><p>Constructs a LyapunovMinimizationCondition which represents not checking for  nonnegativity of the Lyapunov function. This is appropriate in cases where this condition has been structurally enforced.</p><p>It is still possible to check for V(fixed<em>point) = 0, even in this case, for example if V is structured to be positive for state != fixed</em>point, but it is not guaranteed structurally that V(fixed_point) = 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L290-L300">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.ExponentialDecrease-Tuple{Real}" href="#NeuralLyapunov.ExponentialDecrease-Tuple{Real}"><code>NeuralLyapunov.ExponentialDecrease</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ExponentialDecrease(k, strict; check_fixed_point, C)</code></pre><p>Constructs a LyapunovDecreaseCondition corresponding to exponential decrease of rate k.</p><p>If strict is false, the condition is dV/dt ≤ -k * V, and if strict is true, the  condition is dV/dt ≤ -k * V - C * ||state - fixed_point||^2</p><p>The inequality is represented by a ≥ b &lt;==&gt; relu(b-a) = 0.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L431-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.NeuralLyapunovPDESystem-Tuple{SciMLBase.ODEFunction, Any, Any, NeuralLyapunovSpecification}" href="#NeuralLyapunov.NeuralLyapunovPDESystem-Tuple{SciMLBase.ODEFunction, Any, Any, NeuralLyapunovSpecification}"><code>NeuralLyapunov.NeuralLyapunovPDESystem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NeuralLyapunovPDESystem(dynamics, lb, ub, spec; fixed_point, ps)</code></pre><p>Constructs a ModelingToolkit PDESystem to train a neural Lyapunov function</p><p>Returns the PDESystem and a function representing the neural network, which operates columnwise.</p><p>The neural Lyapunov function will only be trained for { x : lb .≤ x .≤ ub }. The Lyapunov function will be for the dynamical system represented by dynamics If dynamics is an ODEProblem or ODEFunction, then the corresponding ODE; if dynamics is a function, then the ODE is ẋ = dynamics(x, p, t). This ODE should not depend on t (time t=0.0 alone will be used) and should have a fixed point at x = fixed_point. The particular Lyapunov conditions to be used and structure of the neural Lyapunov function are specified through spec, which is a NeuralLyapunovSpecification.</p><p>The returned neural network function takes three inputs: the neural network structure phi, the trained network parameters, and a matrix of inputs to operate on columnwise.</p><p>If dynamics requires parameters, their values can be supplied through the Vector p, or through dynamics.p if dynamics isa ODEProblem (in which case, let the other be SciMLBase.NullParameters()). If dynamics is an ODEFunction and dynamics.paramsyms is defined, then p should have the same order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/NeuralLyapunovPDESystem.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.NonnegativeNeuralLyapunov-Tuple{Integer}" href="#NeuralLyapunov.NonnegativeNeuralLyapunov-Tuple{Integer}"><code>NeuralLyapunov.NonnegativeNeuralLyapunov</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NonnegativeNeuralLyapunov(network_dim, δ, pos_def; grad_pos_def, grad)</code></pre><p>Creates a NeuralLyapunovStructure where the Lyapunov function is the L2 norm of the neural network output plus a constant δ times a function pos_def.</p><p>The condition that the Lyapunov function must be minimized uniquely at the fixed point can be represented as V(fixed<em>point) = 0, V(state) &gt; 0 when  state != fixed</em>point. This structure ensures V(state) ≥ 0. Further, if δ &gt; 0 and pos<em>def(fixed</em>point, fixed<em>point) = 0, but pos</em>def(state, fixed<em>point) &gt; 0  when state != fixed</em>point, this ensures that V(state) &gt; 0 when  state != fixed<em>point. This does not enforce V(fixed</em>point) = 0, so that  condition must included in the neural Lyapunov loss function.</p><p>grad<em>pos</em>def(state, fixed<em>point) should be the gradient of pos</em>def with respect to state at state. If grad<em>pos</em>def is not defined, it is evaluated using grad, which defaults to ForwardDiff.gradient.</p><p>The neural network output has dimension network_dim.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L39-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, Function, Function, Any}" href="#NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, Function, Function, Any}"><code>NeuralLyapunov.NumericalNeuralLyapunovFunctions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NumericalNeuralLyapunovFunctions(phi, θ, network_func, V_structure, dynamics, fixed_point, grad)</code></pre><p>Returns the Lyapunov function, its time derivative, and its gradient: V(state), V̇(state), and ∇V(state)</p><p>These functions can operate on a state vector or columnwise on a matrix of state vectors. phi is the neural network with parameters θ. network_func is an output of NeuralLyapunovPDESystem.</p><p>The Lyapunov function structure is defined by     V<em>structure(</em>network<em>func, state, fixed</em>point) Its gradient is calculated using grad, which defaults to ForwardDiff.gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/NeuralLyapunovPDESystem.jl#L330-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, NeuralLyapunovStructure, Function, Any}" href="#NeuralLyapunov.NumericalNeuralLyapunovFunctions-Tuple{Any, Any, Function, NeuralLyapunovStructure, Function, Any}"><code>NeuralLyapunov.NumericalNeuralLyapunovFunctions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NumericalNeuralLyapunovFunctions(phi, θ, network_func, structure, dynamics, fixed_point; jac, J_net)</code></pre><p>Returns the Lyapunov function, its time derivative, and its gradient: V(state), V̇(state), and ∇V(state)</p><p>These functions can operate on a state vector or columnwise on a matrix of state vectors. phi is the neural network with parameters θ. network_func(phi, θ, state) is an output of NeuralLyapunovPDESystem, which evaluates the neural network represented phi with parameters θ at state.</p><p>The Lyapunov function structure is specified in structure, which is a NeuralLyapunovStructure. The Jacobian of the network is either specified via J<em>net(</em>phi, _θ, state) or calculated using jac, which defaults to ForwardDiff.jacobian</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/NeuralLyapunovPDESystem.jl#L271-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.PositiveSemiDefinite-Tuple{}" href="#NeuralLyapunov.PositiveSemiDefinite-Tuple{}"><code>NeuralLyapunov.PositiveSemiDefinite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">PositiveSemiDefinite(check_fixed_point)</code></pre><p>Constructs a LyapunovMinimizationCondition representing      V(state) ≥ 0 If check<em>fixed</em>point is true, then training will also attempt to enforce      V(fixed_point) = 0</p><p>The inequality is represented by a ≥ b &lt;==&gt; relu(b-a) = 0.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L268-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.PositiveSemiDefiniteStructure-Tuple{Integer}" href="#NeuralLyapunov.PositiveSemiDefiniteStructure-Tuple{Integer}"><code>NeuralLyapunov.PositiveSemiDefiniteStructure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">PositiveSemiDefiniteStructure(network_dim; pos_def, non_neg, grad_pos_def, grad_non_neg, grad)</code></pre><p>Creates a NeuralLyapunovStructure where the Lyapunov function is the product of a positive (semi-)definite function pos<em>def which does not depend on the  network and a nonnegative function non</em>neg which does depend the network.</p><p>The condition that the Lyapunov function must be minimized uniquely at the fixed point can be represented as V(fixed<em>point) = 0, V(state) &gt; 0 when  state != fixed</em>point. This structure ensures V(state) ≥ 0. Further, if pos<em>def is 0 only at fixed</em>point (and positive elsewhere) and if non<em>neg is strictly  positive away from fixed</em>point (as is the case for the default values of pos<em>def and non</em>neg), then this structure ensures V(fixed<em>point) = 0 and V(state) &gt; 0  when state != fixed</em>point.</p><p>grad<em>pos</em>def(state, fixed<em>point) should be the gradient of pos</em>def with respect to state at state. Similarly, grad<em>non</em>neg(net, J<em>net, state, fixed</em>point)  should be the gradient of non<em>neg(net, state, fixed</em>point) with respect to  state at state. If grad<em>pos</em>def or grad<em>non</em>neg is not defined, it is evaluated  using grad, which defaults to ForwardDiff.gradient. </p><p>The neural network output has dimension network_dim.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L97-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.StrictlyPositiveDefinite-Tuple{}" href="#NeuralLyapunov.StrictlyPositiveDefinite-Tuple{}"><code>NeuralLyapunov.StrictlyPositiveDefinite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">StrictlyPositiveDefinite(C; check_fixed_point, relu)</code></pre><p>Constructs a LyapunovMinimizationCondition representing      V(state) ≥ C * ||state - fixed<em>point||^2 If check</em>fixed<em>point is true, then training will also attempt to enforce      V(fixed</em>point) = 0</p><p>The inequality is represented by a ≥ b &lt;==&gt; relu(b-a) = 0.0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L245-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.UnstructuredNeuralLyapunov-Tuple{}" href="#NeuralLyapunov.UnstructuredNeuralLyapunov-Tuple{}"><code>NeuralLyapunov.UnstructuredNeuralLyapunov</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">UnstructuredNeuralLyapunov()</code></pre><p>Creates a NeuralLyapunovStructure where the Lyapunov function is the neural network evaluated at state. This does not structurally enforce any Lyapunov  conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.check_decrease-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}" href="#NeuralLyapunov.check_decrease-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.check_decrease</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_decrease(cond::AbstractLyapunovDecreaseCondition)</code></pre><p>True if cond specifies training to meet the Lyapunov decrease condition, false if cond specifies no training to meet this condition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L312-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.check_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}" href="#NeuralLyapunov.check_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.check_fixed_point</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_fixed_point(cond::AbstractLyapunovMinimizationCondition)</code></pre><p>True if cond specifies training for the Lyapunov function to equal zero at the fixed point, false if cond specifies no training to meet this condition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L172-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.check_nonnegativity-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}" href="#NeuralLyapunov.check_nonnegativity-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.check_nonnegativity</code></a> — <span class="docstring-category">Method</span></header><section><div><p>check_nonnegativity(cond::AbstractLyapunovMinimizationCondition)</p><p>True if cond specifies training to meet the Lyapunov minimization condition,  false if cond specifies no training to meet this condition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L162-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.check_stationary_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}" href="#NeuralLyapunov.check_stationary_fixed_point-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.check_stationary_fixed_point</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_stationary_fixed_point(cond::AbstractLyapunovDecreaseCondition)</code></pre><p>True if cond specifies training for the Lyapunov function not to change at the  fixed point, false if cond specifies no training to meet this condition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L322-L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.get_decrease_condition-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}" href="#NeuralLyapunov.get_decrease_condition-Tuple{NeuralLyapunov.AbstractLyapunovDecreaseCondition}"><code>NeuralLyapunov.get_decrease_condition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_decrease_condition(cond::AbstractLyapunovDecreaseCondition)</code></pre><p>Returns a function of V, dVdt, state, and fixed_point that is equal to zero when the Lyapunov decrease condition is met and greater than zero when it is  violated</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L332-L338">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.get_minimization_condition-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}" href="#NeuralLyapunov.get_minimization_condition-Tuple{NeuralLyapunov.AbstractLyapunovMinimizationCondition}"><code>NeuralLyapunov.get_minimization_condition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_minimization_condition(cond::AbstractLyapunovMinimizationCondition)</code></pre><p>Returns a function of V, state, and fixed_point that equals zero when the  Lyapunov minimization condition is met and greater than zero when it&#39;s violated</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/conditions_specification.jl#L182-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeuralLyapunov.local_Lyapunov-Tuple{Function, Any, Any}" href="#NeuralLyapunov.local_Lyapunov-Tuple{Function, Any, Any}"><code>NeuralLyapunov.local_Lyapunov</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_local_Lyapunov(dynamics, state_dim; fixed_point, dynamics_jac)</code></pre><p>Uses semidefinite programming to derive a quadratic Lyapunov function for the linearization of dynamics around fixed_point. Returns (V, dV/dt, ∇V).</p><p>If dynamics<em>jac is nothing, the Jacobian of the dynamics is calculated using  ForwardDiff. Other allowable forms are a function which takes in the state and outputs the jacobian of dynamics or an AbstractMatrix representing the Jacobian at fixed</em>point. If fixed_point is not specified, it defaults to the origin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralLyapunov.jl/blob/5be782c8bbc194792acfe6471566346dd36cf638/src/local_Lyapunov.jl#L1-L12">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 27 February 2024 20:41">Tuesday 27 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
